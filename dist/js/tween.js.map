{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./js/easing.ts","webpack:///./js/interfaces.ts","webpack:///./js/tween.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","expr","nsteps","direction","this","Easing","toString","mirror","ease","concat","easeReverse","symmetry","split","mix","ease_list","map","length","join","reduce","wrap","replace","easeLinear","lt","ease_l","ease_r","lf","rf","bezier","y0","y1","elastic","amplitude","period","Math","PI","asin","steps","toFunction","Function","identifier","interval","easeBack","easeCirc","easeSwing","easeBounce","cubicBezier","easeInBack","easeOutBack","easeInOutBack","easeInCirc","easeOutCirc","easeInOutCirc","easeInBounce","easeOutBounce","easeInOutBounce","forEach","index","ORDER","DIRECTION","POSITION","EASE_LINEAR","data","option","step","parseTween","Tween","parse","left_tween_map","accumulate_values","initial_values","tween_keys","keys","range_set","res","unit","range","ft","target","position","LEFT","tt","RIGHT","sort","b","use_def_ease","blocks","idx","len","cursor","tween","process","range_item","eval_exprs","evaluation_expression","push","ease_expr","es","val","init_exprs","lr","rr","indexOf","splice","j","undefined","actual_duration","actual_begin","begin","loop","key_mask_map","duration","get_evalexpr","expression","calc_expr","ACCUMULATIVE","block","value_expr","tween_code","_binary_search_encode","_sub_blocks","mid","floor","mid_block","slice","_parse_tween_expr","calc_step","ALTERNATE"],"mappings":"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","file":"js/tween.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","\r\n\r\nclass Easing {\r\n    expr: string;\r\n    nsteps: number;\r\n    direction: string;\r\n    static mirror(ease: Easing | string) {\r\n        return Easing.concat(Easing.easeReverse, ease, Easing.easeReverse);\r\n    }\r\n    static symmetry(ease: Easing | string) {\r\n        return Easing.split(0.5, ease);\r\n    }\r\n    static mix(...ease_list: Array<Easing | string>) {\r\n        return new Easing(\r\n            ease_list.map(\r\n                ease => `(${ease.toString()})/${ease_list.length}`\r\n            ).join(\"+\")\r\n        );\r\n    }\r\n    static concat(...ease_list: Array<Easing | string>) {\r\n        return new Easing(\r\n            ease_list.reduce(\r\n                (wrap: string, ease) => wrap.replace(\r\n                    /\\$\\{\\S*?\\$\\S*?\\}/g,\r\n                    `(${ease.toString()})`\r\n                ), Easing.easeLinear.expr)\r\n        );\r\n    }\r\n    static split(lt: number, ease_l: Easing | string, ease_r = ease_l) {\r\n        if (lt > 0 && lt < 1) {\r\n            let lf = 1 / lt, rf = 1 / (1 - lt);\r\n            return new Easing(`__t<${lt}?(__t*=${lf},(${\r\n                ease_l.toString()\r\n                })/${lf}):(__t=(1-__t)*${rf},1-(${\r\n                ease_r.toString()\r\n                })/${rf})`);\r\n        } else {\r\n            return lt <= 0 ? ease_r : ease_l;\r\n        }\r\n    }\r\n    static easeLinear = new Easing(\"${$}\");\r\n    static easeReverse = new Easing(\"1-${$}\");\r\n\r\n    static easeBack = new Easing(\"${$}*${$}*(3*${$}-2)\");\r\n    static easeCirc = new Easing(\"1-Math.sqrt(1-${$}*${$})\");\r\n    static easeSwing = new Easing(\"0.5-Math.cos(${$}*Math.PI)/2\");\r\n    static easeBounce = new Easing(\r\n        \"__a=7.5625,__b=2.75,\" +\r\n        \"${$}<1/__b?\" +\r\n        \"(__a*${$}*${$}):\" +\r\n        \"(${$}<2/__b?\" +\r\n        \"(__a*(__b=${$}-1.5/__b)*__b+0.75):\" +\r\n        \"(${$}<2.5/__b?\" +\r\n        \"(__a*(__b=${$}-2.25/__b)*__b+0.9375):\" +\r\n        \"(__a*(__b=${$}-2.625/__b)*__b+0.984375)\" +\r\n        \"))\"\r\n    );\r\n    static cubicBezier: (mx1: number, my1: number, mx2: number, my2: number) => Easing = null;\r\n    static bezier(y0: number, y1: number) {\r\n        return new Easing(`__a=\\${$},__b=1-__a,3*__b*__b*__a*${y0}+3*__b*__a*__a*${y1}+__a*__a*__a`);\r\n    };\r\n    static elastic(amplitude?: number, period: number = 0.5) {\r\n        let a = amplitude >= 1 ? (amplitude <= 10 ? amplitude : 10) : 1;\r\n        let p = period <= 2 ? (period >= 0.1 ? period : 0.1) : 2;\r\n        let s = p / (Math.PI * 2) * Math.asin(1 / a);\r\n        return new Easing(`\\${$}&&(__b=\\${$}-1,-${a}*Math.pow(2,10*__b)*Math.sin(((__b-${s})*Math.PI*2)/${p}))`);\r\n    };\r\n\r\n    static easeInBack = Easing.easeBack;\r\n    static easeOutBack = Easing.easeInBack.mirror();\r\n    static easeInOutBack = Easing.easeInBack.symmetry();\r\n\r\n    static easeInCirc = Easing.easeCirc;\r\n    static easeOutCirc = Easing.easeInCirc.mirror();\r\n    static easeInOutCirc = Easing.easeInCirc.symmetry();\r\n\r\n    static easeInBounce = Easing.easeBounce;\r\n    static easeOutBounce = Easing.easeInBounce.mirror();\r\n    static easeInOutBounce = Easing.easeOutBounce.symmetry();\r\n\r\n    static easeInQuad: Easing; static easeInCubic: Easing; static easeInQuart: Easing; static easeInQuint: Easing; static easeInExpo: Easing;\r\n\r\n    static easeOutQuad: Easing; static easeOutCubic: Easing; static easeOutQuart: Easing; static easeOutQuint: Easing; static easeOutExpo: Easing;\r\n\r\n    static easeInOutQuad: Easing; static easeInOutCubic: Easing; static easeInOutQuart: Easing; static easeInOutQuint: Easing; static easeInOutExpo: Easing;\r\n\r\n    constructor(\r\n        expr: string | Easing,\r\n        nsteps?: number,\r\n        direction?: string\r\n    ) {\r\n        if (this instanceof Easing) {\r\n            nsteps && (this.nsteps = nsteps);\r\n            direction && (this.direction = direction);\r\n            this.expr = expr instanceof Easing ? expr.toString() : expr;\r\n        } else {\r\n            return new Easing(expr, nsteps, direction);\r\n        }\r\n    }\r\n    mirror() {\r\n        return Easing.mirror(this);\r\n    }\r\n    symmetry() {\r\n        return Easing.symmetry(this);\r\n    }\r\n    split(lt: number = 0.5, ease?: Easing | string) {\r\n        return Easing.split(lt, this, ease);\r\n    }\r\n    steps(nsteps = this.nsteps, direction = this.direction) {\r\n        return new Easing(this.expr, nsteps, direction);\r\n    }\r\n    mix(...ease_list: Array<Easing>) {\r\n        return Easing.mix(this, ...ease_list);\r\n    }\r\n    concat(...ease_list: Array<Easing>) {\r\n        return Easing.concat(this, ...ease_list);\r\n    }\r\n    toFunction() {\r\n        return new Function(\"p\", `var __a,__b,__t;return ${this.toString(\"p\")};`) as (process: number) => number;\r\n    }\r\n    toString(identifier: String = \"${$}\") {\r\n        let interval: number;\r\n        return `__t=${identifier},${\r\n            this.nsteps ?\r\n                `__t!==1 && (__t=(__t-__t%${\r\n                interval = 1 / this.nsteps\r\n                }${\r\n                this.direction === \"start\" ? `+${interval}` : ``\r\n                })),` :\r\n                ``\r\n            }` +\r\n            this.expr.replace(\r\n                /\\$\\{\\S*?\\$\\S*?\\}/g,\r\n                `__t`\r\n            ) + ``;\r\n    }\r\n}\r\n[\"Quad\", \"Cubic\", \"Quart\", \"Quint\", \"Expo\"].forEach(\r\n    (name, index) => {\r\n        let ease = new Easing(`Math.pow(\\${$},${index + 2})`);\r\n        Easing[\"easeIn\" + name] = ease;\r\n        Easing[\"easeOut\" + name] = ease.mirror();\r\n        Easing[\"easeInOut\" + name] = ease.symmetry();\r\n    }\r\n);\r\n\r\nexport default Easing;\r\n\r\n/**\r\n    get easeMirror(){\r\n        return this.mirror();\r\n    }\r\n    get easeSymmetry(){\r\n        return this.symmetry();\r\n    }\r\n    get easeBack() {\r\n        return this.concat(Easing.easeBack);\r\n    }\r\n    get easeCire() {\r\n        return this.concat(Easing.easeCire);\r\n    }\r\n    get easeSwing() {\r\n        return this.concat(Easing.easeSwing);\r\n    }\r\n    get easeBounce() {\r\n        return this.concat(Easing.easeBounce);\r\n    }\r\n */\r\n","\r\nenum ORDER {\r\n    NORMAL = \"normal\",\r\n    AUTO = \"auto\"\r\n}\r\nenum DIRECTION {\r\n    ALTERNATE = \"alternate\",\r\n    ACCUMULATIVE = \"accumulative\",\r\n}\r\nenum POSITION {\r\n    LEFT = -1,\r\n    RIGHT = 1,\r\n    MIDDLE = 0\r\n}\r\n\r\n\r\ninterface TweenOption {\r\n    target?: { [tweenKey: string]: number } | any,\r\n    key_mask_map?: { [tweenKey: string]: number },\r\n    direction?: DIRECTION,\r\n    duration?: number,\r\n    begin?: number,\r\n    loop?: number | boolean,\r\n    es?: Easing,\r\n    keys?: string[],\r\n    msak_map?: { [tweenKey: string]: number }\r\n}\r\n\r\n\r\ninterface Easing {\r\n    steps(nsteps?: number, direction?: string): void,\r\n    concat(...easeing_list: Array<Easing>): Easing,\r\n    toString(target?: string): string,\r\n    toFunction(): (process: number) => number,\r\n}\r\n\r\ninterface AnimationDescriptor {\r\n    name: string,\r\n    keys: string[],\r\n    mask?: number,\r\n    masks?: number[],\r\n    values?: { [propName: string]: number }\r\n    parent?: string,\r\n}\r\n\r\n\r\ninterface TweenData {\r\n    ft?: number,\r\n    tt?: number,\r\n    val: number,\r\n    es?: Easing\r\n}\r\n\r\n\r\ninterface AnimationData extends TweenData {\r\n    key?: string,\r\n    onPlay?: () => boolean | void,\r\n    onEnd?: (dtime?: number) => void,\r\n    [AnimationKey: string]: any//number | Number\r\n}\r\n\r\n\r\n\r\ninterface Matrix {\r\n    valueOf(): string,\r\n    setIdentify?(): void,\r\n    scale?(...axes: number[]): void,\r\n    translate?(...axes: number[]): void,\r\n    rotateY?(angle: number): void,\r\n    rotateX?(angle: number): void,\r\n    rotateZ?(angle: number): void,\r\n    rotate3d?(x: number, y: number, z: number, angle: number): void\r\n}\r\n\r\ninterface AnimationConfig {\r\n    order?: ORDER,\r\n    duration?: number,\r\n    es?: Easing,\r\n    direction?: DIRECTION,\r\n    loop?: number,\r\n    begin?: number,\r\n    speed?: number,\r\n    matrix?: { new(): Matrix }//typeof Matrix,\r\n    sync_keys?: string[]\r\n}\r\n\r\n\r\n\r\nexport {\r\n    DIRECTION,\r\n    POSITION,\r\n    ORDER,\r\n    AnimationDescriptor,\r\n    AnimationData,\r\n    AnimationConfig,\r\n    Matrix,\r\n    TweenOption, TweenData\r\n\r\n}","\r\n\r\nimport Easing from './easing';\r\n\r\nimport { DIRECTION, POSITION, TweenOption, TweenData } from './interfaces';\r\n\r\n\r\n\r\ninterface TweenStep {\r\n    (step: number): number;\r\n}\r\n\r\n\r\ninterface CalcBlock {\r\n    init_exprs: Array<string>,\r\n    eval_exprs: Array<[string, string | number]>,\r\n    lr: number,\r\n    rr: number,\r\n    value_expr?: string\r\n}\r\n\r\n\r\nconst EASE_LINEAR = Easing.easeLinear;\r\n\r\nclass Tween {\r\n    static DIRECTION = DIRECTION;\r\n    step: TweenStep;\r\n    constructor(\r\n        private data: { [tweenKey: string]: Array<TweenData> },\r\n        private option?: TweenOption\r\n    ) {\r\n        if (data) {\r\n            this.step = this.parseTween(data, option);\r\n        }\r\n    }\r\n    protected parseTween(\r\n        data: { [tweenKey: string]: Array<TweenData> },\r\n        option: TweenOption = this.option\r\n    ) {\r\n        return Tween.parse(data, option);\r\n    }\r\n\r\n    static parse(data: { [tweenKey: string]: Array<TweenData> }, option: TweenOption = {}) {\r\n\r\n        let left_tween_map = {};\r\n        let accumulate_values = {};\r\n        let initial_values = {};\r\n        let tween_keys = option.keys || Object.keys(data);\r\n        let range_set = [];\r\n        for (const key of tween_keys) {\r\n            left_tween_map[key] = [];\r\n            initial_values[key] = accumulate_values[key] = 0;\r\n            range_set = range_set.concat(\r\n                data[key].reduce(\r\n                    (res, unit) => {\r\n                        return res.concat(\r\n                            {\r\n                                range: unit.ft || 0,\r\n                                target: unit,\r\n                                position: POSITION.LEFT,\r\n                                key\r\n                            },\r\n                            {\r\n                                range: unit.tt || 0,\r\n                                target: unit,\r\n                                position: POSITION.RIGHT,\r\n                                key\r\n                            }\r\n                        );\r\n                    },\r\n                    []\r\n                )\r\n            );\r\n        }\r\n        range_set.sort(\r\n            (a, b) => {\r\n                let res = a.range - b.range;\r\n                return res || (b.position - a.position);//让右区间优先被处理\r\n            }\r\n        );\r\n\r\n\r\n        let use_def_ease = false;\r\n\r\n        let blocks: Array<CalcBlock> = [];\r\n        for (\r\n            let idx = 0, len = range_set.length, cursor = range_set[0]?.range || 0;\r\n            idx < len;\r\n            idx++\r\n        ) {\r\n            let range_item = range_set[idx];\r\n            if (cursor !== range_item.range) {\r\n                let init_exprs = [];\r\n                let eval_exprs: Array<[string, string | number]> = tween_keys.map(key => [\r\n                    key,\r\n                    left_tween_map[key].reduce(\r\n                        (evaluation_expression: string, tween: TweenData, index: number) => {\r\n                            init_exprs.push(\r\n                                `_${key}_${index}=(_time_-${tween.ft})/${tween.tt - tween.ft}`\r\n                            );\r\n                            let ease_expr = tween.es?.toString?.(`_${key}_${index}`);\r\n                            if (!ease_expr) {\r\n                                ease_expr = `_def_ease(_${key}_${index})`;\r\n                                use_def_ease = true;\r\n                            } else {\r\n                                ease_expr = `(${ease_expr})`;\r\n                            }\r\n                            return evaluation_expression +\r\n                                `+${ease_expr}*${tween.val}`;\r\n                        }\r\n                        , accumulate_values[key] + initial_values[key]\r\n                    )]\r\n                );\r\n                blocks.push(\r\n                    {\r\n                        init_exprs,\r\n                        eval_exprs,\r\n                        lr: cursor,\r\n                        rr: range_item.range\r\n                    }\r\n                );\r\n                cursor = range_item.range;\r\n            }\r\n            if (range_item.position === POSITION.RIGHT) {\r\n                let index = left_tween_map[range_item.key].indexOf(range_item.target);\r\n                if (index !== -1) {\r\n                    left_tween_map[range_item.key].splice(index, 1);\r\n                } else {\r\n                    for (let j = idx + 1; j < len; j++) {\r\n                        if (range_set[j].target === range_item.target) {\r\n                            range_set.splice(j, 1);\r\n                            len--;\r\n                        }\r\n                    }\r\n                }\r\n                let val = _get_value(range_item.target, 1);\r\n                if (range_item.target.tt === undefined) {\r\n                    initial_values[range_item.key] += val;\r\n                } else {\r\n                    accumulate_values[range_item.key] += val;\r\n                }\r\n                continue;\r\n            }\r\n            if (cursor === range_item.range) {\r\n                left_tween_map[range_item.key].push(range_item.target);\r\n            }\r\n        }\r\n\r\n        let actual_duration = blocks.length ? (blocks[blocks.length - 1].rr) : 0;\r\n        let actual_begin = blocks.length ? (blocks[0].lr) : 0;\r\n        let {\r\n            begin = 0,\r\n            loop = 1,\r\n            direction,\r\n            key_mask_map,\r\n            duration = actual_duration,\r\n            target\r\n        } = option;\r\n        typeof loop === \"boolean\" && (loop = loop === true ? 8640000000000 : 1);\r\n\r\n        function _get_value(tween: TweenData, process: number) {\r\n            return (tween.es || option.es || EASE_LINEAR).toFunction()(process) * tween.val;\r\n        }\r\n        function get_evalexpr(key: string, expression: string | number = \"0\") {\r\n            let calc_expr =\r\n                (\r\n                    direction === DIRECTION.ACCUMULATIVE ?\r\n                        (accumulate_values[key] + \"*_loop_+\") :\r\n                        \"\"\r\n                ) + expression;\r\n            if (key_mask_map) {///*typeof expression === \"number\" && */\r\n                return `(__a=${calc_expr})===this._${key}?(status&=${~key_mask_map[key]}):(this._${key}=__a);`;\r\n            } else {\r\n                return `this._${key}=${calc_expr};`\r\n            }\r\n        }\r\n\r\n        for (let block of blocks) {\r\n            let value_expr = \"\";\r\n            for (let [key, expression] of block.eval_exprs) {\r\n                value_expr += get_evalexpr(key, expression);\r\n            }\r\n            block.value_expr = value_expr;\r\n        }\r\n\r\n\r\n\r\n        function _parse_tween_expr(block: CalcBlock) {\r\n            return (block.init_exprs.length ? `var ${block.init_exprs.join(\",\")};` : ``) +\r\n                block.value_expr;\r\n        }\r\n\r\n        function _binary_search_encode(_sub_blocks: Array<CalcBlock>): string {\r\n            let mid = Math.floor(_sub_blocks.length / 2);\r\n            let mid_block = _sub_blocks[mid];\r\n            if (_sub_blocks.length >= 2) {\r\n                return `if(_time_<=${mid_block.lr}){` +\r\n                    _binary_search_encode(_sub_blocks.slice(0, mid)) +\r\n                    `}else{` +\r\n                    _binary_search_encode(_sub_blocks.slice(mid)) +\r\n                    `}`;\r\n            } else {\r\n                return _parse_tween_expr(mid_block);\r\n            }\r\n        }\r\n\r\n        let tween_code = blocks.length ? _binary_search_encode(blocks) : \"return 0;\";\r\n\r\n        let calc_step = new Function(\r\n            `time`,\r\n            `var status=~0,_d_=${duration},_dl_=${duration * loop},__a,__b,__t;` +\r\n            `${use_def_ease ? `function _def_ease(p){${\r\n                `var __a,__b,__t;` +\r\n                `return ` + (option.es || EASE_LINEAR).toString(`p`) + `;`\r\n                }}` : ``}` +\r\n            (begin ? `time+=${begin};` : ``) +\r\n            `var _time_=time>=0?(time<=_dl_?time:_dl_):0;` +\r\n            `var _loop_=_time_/_d_|0;` +\r\n            `_time_=${\r\n            direction === DIRECTION.ALTERNATE ?\r\n                `_loop_%2?(_d_-_time_%_d_):(_time_%_d_)` :\r\n                `_time_%_d_ || (_time_ && (_loop_--,_d_))`\r\n            };` +\r\n            `${actual_duration < duration ? `_time_>${actual_duration} && (_time_=${actual_duration});` : ``}` +\r\n            `${actual_begin > 0 ? `if(_time_<${actual_begin}){${\r\n                tween_keys.reduce((expr, key) =>\r\n                    expr + `__a=${initial_values[key]}${direction === DIRECTION.ACCUMULATIVE ? `+_loop_*${accumulate_values[key]}` : ``},this._${key}===__a?(status&=${~key_mask_map[key]}):(this._${key}=__a);`\r\n                    , \"\")\r\n                }}else{` : ``}` +\r\n            tween_code +\r\n            `${actual_begin > 0 ? `}` : ``}` +\r\n            `return status^(time<=0?6:(time<=_dl_?5:3));`\r\n        ) as TweenStep;\r\n        return target ? calc_step.bind(target) : calc_step;\r\n\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n\r\nexport default Tween;"],"sourceRoot":""}